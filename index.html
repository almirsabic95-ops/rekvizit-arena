<!DOCTYPE html>
<html lang="hr">
<head>
    <meta charset="UTF-8">
    <title>Rekvizit Arena v2</title>
    <script src="/socket.io/socket.io.js"></script>
    <style>
        :root { --main: #00eaff; --bg: #050505; --panel: #111; --gold: #ffd700; }
        body { background: var(--bg); color: white; font-family: sans-serif; margin: 0; display: flex; height: 100vh; overflow: hidden; }
        .hidden { display: none !important; }
        
        /* SIDEBAR LIJEVO */
        #sidebar { width: 300px; background: #000; border-right: 1px solid #333; display: flex; flex-direction: column; }
        .sidebar-section { padding: 15px; border-bottom: 1px solid #222; overflow-y: auto; }
        .user-row { display: flex; align-items: center; gap: 10px; padding: 8px 0; border-bottom: 1px solid #111; }
        .av-mini { width: 30px; height: 30px; border-radius: 50%; border: 1px solid var(--main); }

        /* GLAVNI DIO */
        #main { flex: 1; display: flex; flex-direction: column; }
        .navbar { height: 60px; background: #0a0a0a; border-bottom: 1px solid #333; display: flex; align-items: center; padding: 0 20px; gap: 15px; }
        .nav-btn { background: #222; border: 1px solid #444; color: white; padding: 8px 15px; cursor: pointer; border-radius: 5px; font-weight: bold; }
        .nav-btn:hover { background: var(--main); color: black; }

        /* BANNER */
        .banner-wrap { background: #ff4400; color: white; padding: 5px 0; overflow: hidden; white-space: nowrap; }
        .banner-text { display: inline-block; animation: marquee 15s linear infinite; font-weight: bold; }
        @keyframes marquee { 0% { transform: translateX(100%); } 100% { transform: translateX(-100%); } }

        /* ZONE */
        .content-zone { flex: 1; display: flex; flex-direction: column; padding: 20px; }
        #quiz-box { text-align: center; background: var(--panel); padding: 30px; border-radius: 10px; border: 1px solid var(--main); margin-bottom: 15px; }
        #chat-box { flex: 1; background: #080808; border: 1px solid #222; overflow-y: auto; padding: 15px; margin-top: 10px; }
        
        .timer-circle { font-size: 2em; color: var(--main); margin: 10px; font-weight: bold; }
        input { padding: 12px; background: #000; border: 1px solid #444; color: white; border-radius: 5px; width: 100%; box-sizing: border-box; }
        
        #login-screen { position: fixed; inset: 0; background: var(--bg); z-index: 10000; display: flex; align-items: center; justify-content: center; text-align: center; }
    </style>
</head>
<body>

    <div id="login-screen">
        <div style="background: var(--panel); padding: 40px; border-radius: 15px; border: 1px solid #333; width: 350px;">
            <h1 style="color: var(--main);">ARENA</h1>
            <p style="font-size: 12px; color: #888;">Ulazom u Arenu, prihvatate naÅ¡a pravila i uslove.</p>
            <div id="login-form">
                <input id="l-nick" placeholder="Nadimak" onkeydown="if(event.key==='Enter') login()"><br><br>
                <input type="password" id="l-pass" placeholder="Lozinka" onkeydown="if(event.key==='Enter') login()"><br><br>
                <button class="nav-btn" style="width:100%" onclick="login()">ULAZ U ARENU</button>
            </div>
            <div id="reg-form" class="hidden">
                <input id="r-secret" placeholder="Tajna Å¡ifra"><br><br>
                <button class="nav-btn" style="width:100%" onclick="register()">DOVRÅ I</button>
            </div>
        </div>
    </div>
    <div id="sidebar">
        <div class="sidebar-section">
            <h4 style="color: var(--main)">ONLINE IGRAÄŒI</h4>
            <div id="online-list"></div>
        </div>
        <div class="sidebar-section" id="mini-leaderboard">
            <h4 style="color: var(--gold)">TOP 10 BODOVA</h4>
            <div id="mini-lb-list"></div>
        </div>
    </div>

    <div id="main">
        <div class="banner-wrap">
            <div class="banner-text">1vs1 dvoboj vam omoguÄ‡uje veÄ‡i broj bodova i nagrada! Izazovite protivnika odmah!</div>
        </div>
        
        <div class="navbar">
            <button class="nav-btn" onclick="showZone('quiz')">KVIZ</button>
            <button class="nav-btn" onclick="showZone('chat')">CHAT</button>
            <button class="nav-btn" onclick="showZone('1vs1')">1vs1 DVOBOJ</button>
            <button class="nav-btn" onclick="showZone('leaderboard')">TABLICA</button>
            <button class="nav-btn" onclick="showZone('wheel')">KOLO SREÄ†E</button>
            <button class="nav-btn" onclick="showZone('shop')">TRGOVINA</button>
            <div style="flex:1"></div>
            <span id="stat-coins" style="color:var(--gold)">0 ðŸ’°</span>
            <button class="nav-btn" style="color:red" onclick="location.reload()">ODJAVA</button>
        </div>

        <div id="zone-quiz" class="content-zone">
            <div id="quiz-box">
                <span id="q-kat" style="color: var(--main); font-weight: bold;">KATEGORIJA</span>
                <div class="timer-circle" id="timer">30</div>
                <h2 id="q-text">Spremite se...</h2>
                <input id="q-ans" placeholder="OVDE UPIÅ I ODGOVOR ZA KVIZ..." onkeydown="if(event.key==='Enter') sendAns()">
            </div>
            <div id="chat-box"></div>
            <input id="c-in" placeholder="OVDE PIÅ I ZA GLOBALNI CHAT..." onkeydown="if(event.key==='Enter') sendChat()">
        </div>

        <div id="zone-leaderboard" class="content-zone hidden">
            <div style="display:flex; gap:10px; margin-bottom:20px;">
                <button class="nav-btn">DNEVNA</button>
                <button class="nav-btn">TJEDNA</button>
                <button class="nav-btn">UKUPNA</button>
            </div>
            <div id="full-lb" style="background: #111; padding: 20px; border-radius: 10px; overflow-y:auto;"></div>
        </div>
        
        <div id="zone-1vs1" class="content-zone hidden">
            <h2>Izaberi protivnika za 1vs1:</h2>
            <div id="duel-list"></div>
        </div>
    </div>
    <script>
        const socket = io();

        function login() { socket.emit('pokusaj_prijave', { nadimak: document.getElementById('l-nick').value, lozinka: document.getElementById('l-pass').value }); }
        socket.on('otvori_registraciju', () => { document.getElementById('login-form').classList.add('hidden'); document.getElementById('reg-form').classList.remove('hidden'); });
        function register() { socket.emit('registracija', { nadimak: document.getElementById('l-nick').value, lozinka: document.getElementById('l-pass').value, tajna_sifra: document.getElementById('r-secret').value }); }

        socket.on('prijava_uspjesna', u => { document.getElementById('login-screen').classList.add('hidden'); updateStats(u); });
        
        function sendAns() { socket.emit('slanje_odgovora', { odgovor: document.getElementById('q-ans').value }); document.getElementById('q-ans').value = ""; }
        function sendChat() { socket.emit('chat_global', document.getElementById('c-in').value); document.getElementById('c-in').value = ""; }

        socket.on('novo_pitanje', d => { document.getElementById('q-text').innerText = d.tekst; document.getElementById('q-kat').innerText = d.kat; });
        socket.on('timer_update', s => { document.getElementById('timer').innerText = s; });

        socket.on('chat_msg', d => {
            const b = document.getElementById('chat-box');
            b.innerHTML += `<div><b>${d.od}:</b> ${d.tekst}</div>`;
            b.scrollTop = b.scrollHeight;
        });

        socket.on('update_online', users => {
            const list = document.getElementById('online-list');
            const duelList = document.getElementById('duel-list');
            const html = users.map(u => `<div class="user-row"><img src="${u.avatar}" class="av-mini"> ${u.nadimak} ${u.aktivniBedz || ''} <b>(${u.bodovi})</b></div>`).join('');
            list.innerHTML = html;
            duelList.innerHTML = users.map(u => `<div class="user-row">${u.nadimak} <button class="nav-btn" onclick="socket.emit('izazovi_igraca', '${u.id}')">IZAZOVI</button></div>`).join('');
        });

        socket.on('update_leaderboard', list => {
            document.getElementById('mini-lb-list').innerHTML = list.slice(0,10).map((u,i) => `<div>${i+1}. ${u.nadimak} (${u.bodovi})</div>`).join('');
            document.getElementById('full-lb').innerHTML = `<table><tr style="color:var(--main)"><th>Mesto</th><th>Nadimak</th><th>Bodovi</th></tr>` + 
                list.map((u,i) => `<tr><td>${i+1}</td><td>${u.nadimak}</td><td>${u.bodovi}</td></tr>`).join('') + `</table>`;
        });

        function showZone(z) {
            document.querySelectorAll('.content-zone').forEach(e => e.classList.add('hidden'));
            document.getElementById('zone-' + z).classList.remove('hidden');
        }

        function updateStats(u) { document.getElementById('stat-coins').innerText = u.coinsi + " ðŸ’°"; }
        socket.on('update_stats', updateStats);
        socket.on('greska', m => alert(m));
    </script>
</body>
</html>