<!DOCTYPE html>
<html lang="hr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sretan Roƒëendan!</title>
    <link href="https://fonts.googleapis.com/css2?family=Dancing+Script:wght@600&family=Great+Vibes&display=swap" rel="stylesheet">
    <style>
        :root { --pink: #ff85a2; --dark-pink: #f06292; }
        body { margin: 0; display: flex; justify-content: center; align-items: center; min-height: 100vh; background: #fff5f7; font-family: 'Segoe UI', sans-serif; overflow: hidden; }

        /* Kontejner za srce */
        .heart-wrapper { position: relative; width: 300px; height: 260px; cursor: pointer; transition: transform 0.3s; }
        .heart-wrapper:hover { transform: scale(1.05); }

        /* Ru≈æe (Okvir) */
        .rose-border { position: absolute; top: -20px; left: -20px; right: -20px; bottom: -20px; border: 15px double var(--pink); border-radius: 50% 50% 50% 50% / 40% 40% 60% 60%; z-index: 1; pointer-events: none; }

        /* Glavno srce podijeljeno na dvoja vrata */
        .heart-door { position: absolute; width: 50%; height: 100%; background: var(--pink); z-index: 3; transition: transform 1.5s cubic-bezier(0.4, 0, 0.2, 1); }
        .left-door { left: 0; border-radius: 150px 150px 0 150px; transform-origin: left; border-right: 1px solid rgba(255,255,255,0.3); }
        .right-door { right: 0; border-radius: 150px 150px 150px 0; transform-origin: right; }

        .open .left-door { transform: rotateY(-140deg); }
        .open .right-door { transform: rotateY(140deg); }

        /* Unutra≈°njost srca (Tekst) */
        .content { position: absolute; width: 100%; height: 100%; display: flex; flex-direction: column; justify-content: center; align-items: center; text-align: center; padding: 20px; box-sizing: border-box; z-index: 2; background: white; border-radius: 150px 150px 150px 150px / 120px 120px 180px 180px; }
        .text { font-family: 'Dancing Script', cursive; font-size: 1.2rem; color: #444; opacity: 0; transform: translateY(20px); transition: all 1s ease; }
        .open .text { opacity: 1; transform: translateY(0); transition-delay: 1.5s; }

        /* Modal (Prozor za datum) */
        #modal { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.6); z-index: 10; display: none; justify-content: center; align-items: center; }
        .modal-box { background: white; padding: 30px; border-radius: 20px; text-align: center; width: 80%; max-width: 400px; border: 4px solid var(--pink); }
        input[type="date"] { padding: 10px; margin: 20px 0; border: 2px solid var(--pink); border-radius: 10px; width: 90%; font-size: 1rem; }
        button { background: var(--pink); color: white; border: none; padding: 10px 25px; border-radius: 20px; cursor: pointer; font-weight: bold; }

        /* Kljuƒç animacija */
        #key { position: absolute; font-size: 50px; display: none; z-index: 5; transition: all 1s ease; }
    </style>
</head>
<body>

    <div class="heart-wrapper" id="heartBox" onclick="showModal()">
        <div class="rose-border"></div>
        <div class="heart-door left-door"></div>
        <div class="heart-door right-door"></div>
        <div class="content">
            <p class="text">
                Sretan roƒëendan ≈æeni koja moj ≈æivot ƒçini potpunim.<br><br>
                Svaki dan s tobom je nova stranica najljep≈°e priƒçe.<br><br>
                Hvala ti ≈°to si moj oslonac, moja radost i moja najveƒáa ljubav.<br>
                <strong>Volim te zauvijek!</strong>
            </p>
        </div>
    </div>

    <div id="key">üîë</div>

    <div id="modal">
        <div class="modal-box">
            <h3>Upi≈°i svoj datum roƒëenja ‚ù§Ô∏è</h3>
            <input type="date" id="birthDate">
            <br>
            <button onclick="sendDate()">PO≈†ALJI</button>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.5.1/dist/confetti.browser.min.js"></script>
    <script>
        function showModal() {
            if (!document.getElementById('heartBox').classList.contains('open')) {
                document.getElementById('modal').style.display = 'flex';
            }
        }

        async function sendDate() {
            const datum = document.getElementById('birthDate').value;
            const res = await fetch('/provjeri-datum', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ datum })
            });
            const data = await res.json();

            if (data.success) {
                document.getElementById('modal').style.display = 'none';
                startUnlockSequence();
            } else {
                alert(data.message);
            }
        }

        function startUnlockSequence() {
            const key = document.getElementById('key');
            key.style.display = 'block';
            key.style.top = '50%';
            key.style.left = '50%';
            key.style.transform = 'translate(-50%, -50%) rotate(45deg)';

            setTimeout(() => {
                key.style.transform = 'translate(-50%, -50%) rotate(90deg) scale(1.5)';
                setTimeout(() => {
                    key.style.opacity = '0';
                    document.getElementById('heartBox').classList.add('open');
                    confetti({ particleCount: 150, spread: 70, origin: { y: 0.6 } });
                }, 1000);
            }, 1000);
        }
    </script>
</body>
</html>