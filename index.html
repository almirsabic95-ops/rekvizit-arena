<!DOCTYPE html>
<html lang="hr">
<head>
    <meta charset="UTF-8">
    <title>Rekvizit Arena</title>
    <style>
        /* OSNOVNI STILOVI */
        body { background: #000; color: white; font-family: 'Segoe UI', sans-serif; margin: 0; }
        .container { text-align: center; padding: 50px; }
        .hidden { display: none !important; }

        /* PROFIL I AVATAR */
        .profile-card { background: #1e1e1e; border: 1px solid #333; padding: 15px; border-radius: 12px; display: inline-block; }
        .avatar-wrapper { position: relative; width: 100px; height: 100px; margin: 0 auto; }
        .main-avatar { width: 80px; height: 80px; border-radius: 50%; margin-top: 10px; }
        .avatar-frame { position: absolute; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none; }

        /* KVIZ I SPECIJALNI MODOVI */
        #kviz-prostor { padding: 30px; border-radius: 15px; border: 2px solid #333; transition: 0.5s; }
        .iznenadna-borba-aktivna { 
            border: 10px solid #ff0000 !important; 
            box-shadow: inset 0 0 50px #ff0000; 
            animation: pulsiranje 1s infinite alternate; 
        }
        .profesor-mod-aktivno { border: 10px solid #007bff !important; background-color: #001a33; }
        @keyframes pulsiranje { from { opacity: 1; } to { opacity: 0.7; } }

        /* HODAJUÄ†I BANNERI */
        .promo-banner { background: linear-gradient(90deg, #ff0000, #990000); color: white; padding: 8px 0; overflow: hidden; border-bottom: 2px solid gold; }
        .marquee { display: inline-block; white-space: nowrap; animation: kretanje 25s linear infinite; }
        @keyframes kretanje { 0% { transform: translateX(100%); } 100% { transform: translateX(-100%); } }

        /* SIDEBOARD (TOP 10) */
        #sideboard { position: fixed; right: 0; top: 0; width: 220px; height: 100vh; background: #161616; border-left: 2px solid #007bff; padding: 15px; }

        /* MODALNI PROZORI */
        .modal { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.85); display: flex; align-items: center; justify-content: center; z-index: 1000; }
        .modal-content { background: #1e1e1e; padding: 30px; border-radius: 15px; border: 2px solid #007bff; max-width: 400px; text-align: center; }
    </style>
</head>
<body>

    <div id="ucilica-banner" class="promo-banner">
        <div class="marquee">ğŸš€ UÄŒILICA - USKORO! Testiraj znanje i osvoji nagrade! ğŸ“</div>
    </div>

    <div id="login-screen" class="container">
        <h1>ğŸŸï¸ Rekvizit Arena</h1>
        <input type="text" id="login-nadimak" placeholder="Nadimak">
        <input type="password" id="login-lozinka" placeholder="Lozinka">
        <button onclick="pokreniLogin()">Ulaz u Arenu</button>
        <p onclick="prikaziZaboravljeno()" style="cursor:pointer; color:#aaa;">Zaboravljena lozinka?</p>
    </div>

    <div id="main-menu" class="hidden">
        <div class="profile-card">
            <div class="avatar-wrapper">
                <img id="prikaz-avara" src="default-avatar.png" class="main-avatar">
                <img id="prikaz-okvira" src="basic-frame.png" class="avatar-frame">
            </div>
            <h3 id="prikaz-nadimka">IgraÄ</h3>
            <p>ğŸ’° <span id="prikaz-coinsa">0</span></p>
        </div>

        <div id="kviz-prostor">
            <h2 id="pitanje-tekst">Odaberi kategoriju...</h2>
            <div id="kviz-tajmer" style="font-size: 40px;">30</div>
            <input type="text" id="kviz-odgovor" placeholder="UpiÅ¡i odgovor..." onkeydown="if(event.key==='Enter') posaljiKvizOdgovor()">
        </div>
    </div>

    <div id="sideboard">
        <div style="color: gold;">ğŸ† TOP 10 ARENA</div>
        <div id="top-ljestvica"></div>
        <hr>
        <div style="color: #28a745;">ğŸŸ¢ ONLINE</div>
        <div id="online-lista"></div>
    </div>

    <div id="pm-prozori-kontejner" style="position:fixed; bottom:0; right:230px; display:flex; gap:10px;"></div>

    <script src="/socket.io/socket.io.js"></script>
    <script>
        const socket = io();
        // Ovdje Ä‡emo ubaciti JS logiku u sljedeÄ‡em koraku
    </script>
</body>
</html>

    <div id="ucilica-banner" class="promo-banner">
        <div class="marquee">ğŸš€ UÄŒILICA - USKORO! Testiraj znanje i osvoji nagrade! ğŸ“</div>
    </div>

    <div id="login-screen" class="container">
        <h1>ğŸŸï¸ Rekvizit Arena</h1>
        <input type="text" id="login-nadimak" placeholder="Nadimak">
        <input type="password" id="login-lozinka" placeholder="Lozinka">
        <button onclick="pokreniLogin()">Ulaz u Arenu</button>
        <p onclick="prikaziZaboravljeno()" style="cursor:pointer; color:#aaa;">Zaboravljena lozinka?</p>
    </div>

    <div id="main-menu" class="hidden">
        <div class="profile-card">
            <div class="avatar-wrapper">
                <img id="prikaz-avara" src="default-avatar.png" class="main-avatar">
                <img id="prikaz-okvira" src="basic-frame.png" class="avatar-frame">
            </div>
            <h3 id="prikaz-nadimka">IgraÄ</h3>
            <p>ğŸ’° <span id="prikaz-coinsa">0</span></p>
        </div>

        <div id="kviz-prostor">
            <h2 id="pitanje-tekst">Odaberi kategoriju...</h2>
            <div id="kviz-tajmer" style="font-size: 40px;">30</div>
            <input type="text" id="kviz-odgovor" placeholder="UpiÅ¡i odgovor..." onkeydown="if(event.key==='Enter') posaljiKvizOdgovor()">
        </div>
    </div>

    <div id="sideboard">
        <div style="color: gold;">ğŸ† TOP 10 ARENA</div>
        <div id="top-ljestvica"></div>
        <hr>
        <div style="color: #28a745;">ğŸŸ¢ ONLINE</div>
        <div id="online-lista"></div>
    </div>

    <div id="pm-prozori-kontejner" style="position:fixed; bottom:0; right:230px; display:flex; gap:10

// --- PRIJAVA I LOGIN ---
function pokreniLogin() {
    const nadimak = document.getElementById('login-nadimak').value;
    const lozinka = document.getElementById('login-lozinka').value;
    if (nadimak && lozinka) {
        socket.emit('prijava', { nadimak, lozinka });
    }
}

socket.on('prijavljen', (u) => {
    document.getElementById('login-screen').classList.add('hidden');
    document.getElementById('main-menu').classList.remove('hidden');
    document.getElementById('prikaz-nadimka').innerText = u.nadimak;
});

// --- KVIZ I BODOVANJE ---
function posaljiKvizOdgovor() {
    const input = document.getElementById('kviz-odgovor');
    if (input.value.trim() !== "") {
        socket.emit('slanje_odgovora', input.value);
        input.value = "";
    }
}

socket.on('novo_pitanje', (data) => {
    document.getElementById('pitanje-tekst').innerText = data.pitanje;
    document.getElementById('kviz-odgovor').disabled = false;
    document.getElementById('kviz-odgovor').placeholder = "UpiÅ¡i odgovor...";
});

socket.on('vrijeme', (s) => {
    const t = document.getElementById('kviz-tajmer');
    t.innerText = s;
    // DinamiÄka promjena boje tajmera
    if (s <= 10) t.style.color = "#dc3545"; // Crveno
    else if (s <= 15) t.style.color = "#ffc107"; // Å½uto
    else t.style.color = "#28a745"; // Zeleno
});

// --- PRIVATNE PORUKE (PM) ---
function otvoriPrivatniChat(nadimak) {
    if (document.getElementById(`pm-${nadimak}`)) return;
    const html = `
        <div class="pm-prozor" id="pm-${nadimak}">
            <div class="pm-header">
                <span>ğŸ’¬ ${nadimak}</span>
                <span onclick="document.getElementById('pm-${nadimak}').remove()">âœ–</span>
            </div>
            <div class="pm-poruke" id="pm-poruke-${nadimak}"></div>
            <div class="pm-input-zona">
                <input type="text" placeholder="Tipkaj..." 
                       onkeydown="if(event.key==='Enter') slanjePM('${nadimak}')" id="pm-input-${nadimak}">
            </div>
        </div>`;
    document.getElementById('pm-prozori-kontejner').innerHTML += html;
}

function slanjePM(nadimak) {
    const input = document.getElementById(`pm-input-${nadimak}`);
    const tekst = input.value.trim();
    if (tekst !== "") {
        socket.emit('posalji_privatnu_poruku', { kome: nadimak, tekst: tekst });
        input.value = "";
    }
}

socket.on('prijem_privatne_poruke', (data) => {
    otvoriPrivatniChat(data.od);
    const box = document.getElementById(`pm-poruke-${data.od}`);
    box.innerHTML += `<div style="color:#28a745">${data.od}: ${data.tekst}</div>`;
    new Audio('/sounds/pm_notify.mp3').play();
});

// --- SPECIJALNI MODAVI (Borba i Profesor) ---
socket.on('start_iznenadna_borba', () => {
    document.getElementById('kviz-prostor').classList.add('iznenadna-borba-aktivna');
    alert("PAÅ½NJA: Krenula je IZNENADNA BORBA! Bodovi su dupli, ali i kazne!");
});

socket.on('kraj_iznenadne_borbe', () => {
    document.getElementById('kviz-prostor').classList.remove('iznenadna-borba-aktivna');
});

socket.on('obavijest_profesor', (poruka) => {
    document.getElementById('kviz-prostor').classList.add('profesor-mod-aktivno');
    document.querySelector('.marquee').innerText = poruka;
});

// --- ANTI-CHEAT (Split Screen & Visibility) ---
document.addEventListener("visibilitychange", () => {
    if (document.visibilityState === 'hidden') {
        document.getElementById('kviz-odgovor').disabled = true;
        document.getElementById('kviz-odgovor').placeholder = "Blokirani ste zbog izlaska!";
        socket.emit('log_sumnje', 'IgraÄ je napustio tab.');
    }
});

// --- KOLO SREÄ†E ---
function otvoriKolo() {
    document.getElementById('modal-kolo').classList.remove('hidden');
}

function pokreniKolo() {
    socket.emit('zavrti_kolo');
    document.getElementById('spin-btn').disabled = true; // SprijeÄi viÅ¡e klikova
}

socket.on('kolo_rezultat', (data) => {
    const tocak = document.getElementById('wheel');
    tocak.style.transform = `rotate(${data.stupnjevi}deg)`; // Animacija okretanja
    
    // CS 1.6 zvuk okretanja
    new Audio('/sounds/spin.mp3').play();

    setTimeout(() => {
        alert("ÄŒESTITAMO! Osvojili ste: " + data.nagrada);
        new Audio('/sounds/tada.mp3').play(); // Zvuk pobjede
        document.getElementById('modal-kolo').classList.add('hidden');
        document.getElementById('spin-btn').disabled = false;
    }, 4500); // 4s animacija + 0.5s zadrÅ¡ka
});

// --- ADMIN PANEL ---
function otvoriAdminPanel() {
    socket.emit('admin_zahtjev_podataka');
    document.getElementById('admin-panel').classList.remove('hidden');
}

socket.on('admin_podaci_odgovor', (igraci) => {
    const lista = document.getElementById('admin-lista-igraca');
    lista.innerHTML = igraci.map(i => `
        <tr>
            <td>${i.nadimak}</td>
            <td>${i.ukupni_bodovi}</td>
            <td>${i.coinsi}</td>
            <td>${i.isShadowbanned ? 'ğŸ”‡ SHADOW' : 'âœ… OK'}</td>
            <td>
                <button class="btn-shadow" onclick="adminShadow('${i.nadimak}')">Shadow</button>
                <button class="btn-coin" onclick="adminCoin('${i.nadimak}')">+100ğŸ’°</button>
                <button class="btn-ban" onclick="adminKick('${i.nadimak}')">KICK</button>
            </td>
        </tr>
    `).join('');
});

function adminShadow(nick) { socket.emit('admin_shadowban', nick); }
function adminCoin(nick) { socket.emit('admin_dodaj_coinse', { nadimak: nick, iznos: 100 }); }
function adminKick(nick) { if(confirm("Izbaci igraÄa?")) socket.emit('admin_kick', nick); }

// Zatvaranje modala na klik izvan sadrÅ¾aja
window.onclick = function(event) {
    if (event.target.className === 'modal') {
        event.target.classList.add('hidden');
    }
}